| Ідентифікатор та назва атаки | Вимоги (FR, NFR) | Приклад вразливостей, які може використовувати атака | Приклад запобігання успішної реалізації атаки
| ---------------- | ---------------------------------- | ---------------------------- | ----------------------------- |
| A2 - Cryptographic Failures(невдачі у криптографії) | FR1 - підключити крипто-гаманець користувача до сайту | У випадку використання HTTP - це дає можливість атакуючому бачити адрес гаманця, баланс, дії та пропонувати транзакції. В будь-якому разі їх виконання можливе лише при підтвердженні користувачем, але втрата приватності це небажаний результат. | Використання HTTPS для зв'язку з фронтендом. |
| A5 - Security Misconfiguration(неправильна конфігурація безпеки), A2 - Cryptographic Failures(невдачі у криптографії) | FR2 - приймати ETH платежі від користувачів | Найбільшу небезпеку представляють з'єднання з сайтом, а також з'єднання Metamask з RPC провайдером (який дає доступ до блокчейну), який може відбуватися як через HTTP так і через HTTPS. У випадку використання незахищеного каналу для зв'язку з сайтом, якщо для визову функції контракту потрібно вводити дані (наприклад адресу куди надсилати гроші чи кількість надсилаємих грошей) - ці параметри можуть бути перехоплені і змінені. Якщо змінену кількість грошей можна побачити під час підтвердження операції, то зміну адреси дуже важко помітити. У випадку використання HTTP для зв'язку з RPC провайдером користувачу загрожує втрата приватності. Для проведення операцій Metamask використовує протокол JSON RPC, канал зв'язку - HTTP або HTTPS. У випадку використання HTTP нападник може перехопити дані транзакції - адресу гаманця, адресу смарт-контракту до якого направлений запит + будь-які інші параметри запиту. На відміну від 1-го випадку саму транзакцію нападник не зможе змінити через наявність transaction signature, який є результатом хешування усіх дійсних параметрів транзакції + приватного ключа гаманця Metamask. Якщо буде невідповідність, то транзакція буде відхилена. У випадку неправильного налаштування безпеки фронтенду (у даному випадку next.js) буде можлива атака cross-site scripting (XSS), що дозволить нападнику замінити функції, які відповідають за генерацію транзакцій для Metamask, які будуть відправлені на блокчейн. Може бути будь-яка заміна, від простої зміни адреси куди посилаються гроші до визовів до взагалі інших функцій. | Використання виключно HTTPS з'єднання з фронтендом та HTTPS url для RPC провайдера (через якого відбувається доступ до блокчейну). Для налаштувань безпеки увімкнути автоматичний ескейпінг HTML, використання content security policy (політика безпеки вмісту). | | |
| | FR3 - розігрувати зібрані кошти по раундам |  | Операція усередині Ethereum Virtual Machine. |
| A5 - Security Misconfiguration(неправильна конфігурація безпеки), A2 - Cryptographic Failures(невдачі у криптографії) | FR3.1 - дозволити користувачу приєднатися до наступного раунду | Аналогічно до FR2. | Аналогічно до FR2.  |
| | FR3.2 - перевірити щоб користувач міг приєднатися до наступного раунду лише 1 раз |  | Операція усередині Ethereum Virtual Machine. |
| | FR3.3 - автоматично починати/завершувати раунди |  | Операція усередині Ethereum Virtual Machine. |
| | FR3.4 - обрати випадкового переможця серед учасників раунду |  | Операція усередині Ethereum Virtual Machine. |
| | FR3.5 - зберігати події вибору переможця |  | Операція усередині Ethereum Virtual Machine. |
| | FR3.6 - перевіряти щоб цільова сума була зібрана перед кінцем ранду |  | Операція усередині Ethereum Virtual Machine. |
| A5 - Security Misconfiguration(неправильна конфігурація безпеки), A2 - Cryptographic Failures(невдачі у криптографії) | FR4 - системa досягнень для кожного користувача | Аналогічно до FR2. Досягнення відкриваються через взаємодію зі смарт-контрактом. | Аналогічно до FR2 |
| | FR4.1 - зберігати загальну внесену суму / кількість раундів у яких користувач брав участь / кількість перемог у раундах |  | Операція усередині Ethereum Virtual Machine. |
| | FR4.2 - перевіряти умови для відкриття досягнень |  | Операція усередині Ethereum Virtual Machine. |
| | FR4.3 - зберігати які досягнення користувач відкрив, а які ні |  | Операція усередині Ethereum Virtual Machine. |
| A5 - Security Misconfiguration(неправильна конфігурація безпеки), A2 - Cryptographic Failures(невдачі у криптографії) | FR4.4 - друкувати (mint) NFT досягненень | Аналогічно до FR2. Створення NFT потребує взаємодії зі смарт-контрактом. | Аналогічно до FR2. |
| A5 - Security Misconfiguration(неправильна конфігурація безпеки), A2 - Cryptographic Failures(невдачі у криптографії) | FR5 - аватари для кожного користувача | Аналогічно до FR2. Аватари відкриваються через взаємодію зі смарт-контрактом. | Аналогічно до FR2. |
| A5 - Security Misconfiguration(неправильна конфігурація безпеки), A2 - Cryptographic Failures(невдачі у криптографії) | FR5.1 - дозволити користувачу обирати активний аватар серед NFT проекту, які йому належать | Аналогічно до FR2. Аватари обираються через взаємодію зі смарт-контрактом. | Аналогічно до FR2. |
| A5 - Security Misconfiguration(неправильна конфігурація безпеки), A2 - Cryptographic Failures(невдачі у криптографії) | FR6 - NFT колекції | Аналогічно до FR2, але лише втрата приватності, адже це запити на отримання даних, а не на проведення операцій. | Аналогічно до FR2. |
| A5 - Security Misconfiguration(неправильна конфігурація безпеки), A2 - Cryptographic Failures(невдачі у криптографії) | FR6.1 - друкувати (mint) нові NFT за бажанням власника | Небезпеки аналогічно FR2, за виключенням неправильного налаштування безпеки. Ця операція відбувається окремо від сайту, використовуючи приватний ключ власника і url довіреного RPC провайдера, який встановлює зв'язок з довіреним RPC провайдером. | Використання лише HTTPS url для зв'язку з довіреним RPC провайдером. |
| A5 - Security Misconfiguration(неправильна конфігурація безпеки), A2 - Cryptographic Failures(невдачі у криптографії) | FR6.2 - повідомляти користувачів про нові колекції NFT | Аналогічно до FR2, але лише втрата приватності, адже це запити на отримання даних, а не на проведення операцій. | Аналогічно до FR2. |
| A2 - Cryptographic Failures(невдачі у криптографії) | FR6.3 - масово виставляти нові NFT на продаж | Операція відбувається окремо від сайту вручну власником через використання API OpenSea. У випадку використання незахищеного каналу зв'язку можлива втрата приватності і ключа. | Використання виключно HTTPS для користування API. |
| | ... | ... | ... | ... |
| A2 - Cryptographic Failures(невдачі у криптографії) | NFR1 - дозволити користувачам підключатись через кнопку, яка перекидує їх на гаманець Metamask | Аналогічно до FR1. | Аналогічно до FR1. |
| A5 - Security Misconfiguration(неправильна конфігурація безпеки), A2 - Cryptographic Failures(невдачі у криптографії) | NFR2 - виводити на екран повідомлення в нижньому правому кутку про успішність або неуспішність операцій | Аналогічно до FR2, але лише втрата приватності, адже це запити на отримання даних, а не на проведення операцій. | Аналогічно до FR2. |
| | NFR3 - додати задній фон з ефектом паралакс до основної сторінки |  |  |
| A5 - Security Misconfiguration(неправильна конфігурація безпеки), A2 - Cryptographic Failures(невдачі у криптографії) | NFR4 - виводити на екран попередження про необхідність прийняти правила та умови перед користуванням через Metamask | Аналогічно до FR2. В даному випадку мова йде про підпис через Metamask, можливість нанесення шкоди не менше ніж при підміні параметрів транзакцій. | Аналогічно до FR2. |
| A5 - Security Misconfiguration(неправильна конфігурація безпеки), A2 - Cryptographic Failures(невдачі у криптографії) | NFR5 - блокувати кнопки взаємодії з контрактом після кінця раунду, до початку наступного | Аналогічно до FR2, але лише втрата приватності, адже це запити на отримання даних, а не на проведення операцій. | Аналогічно до FR2. |
| A5 - Security Misconfiguration(неправильна конфігурація безпеки), A2 - Cryptographic Failures(невдачі у криптографії) | NFR6 - відображати іконки відкритих досягнень кольровими, а закритих - чорно-білими | Аналогічно до FR2, але лише втрата приватності, адже це запити на отримання даних, а не на проведення операцій. | Аналогічно до FR2. |
| A5 - Security Misconfiguration(неправильна конфігурація безпеки), A2 - Cryptographic Failures(невдачі у криптографії) | NFR7 - відображати дії всіх користувачів у правому верхньому кутку на головній сторінці | Аналогічно до FR2, але лише втрата приватності, адже це запити на отримання даних, а не на проведення операцій. | Аналогічно до FR2. |
| A5 - Security Misconfiguration(неправильна конфігурація безпеки), A2 - Cryptographic Failures(невдачі у криптографії) | NFR8 - відображати статистику користувачів у якості списку знизу їх профілю | Аналогічно до FR2, але лише втрата приватності, адже це запити на отримання даних, а не на проведення операцій. | Аналогічно до FR2. |
| | NFR9 - під час завантаження даних відображати preloader у вигляді планети на орбіті |  |  |
| A5 - Security Misconfiguration(неправильна конфігурація безпеки), A2 - Cryptographic Failures(невдачі у криптографії) | NFR10 - відображати аватар та гаманець переможця діючого раунду посередині головної сторінки | Аналогічно FR2, але без загрози підміни параметрів транзакцій, адже це запит лише на отримання даних. | Аналогічно FR2. |

