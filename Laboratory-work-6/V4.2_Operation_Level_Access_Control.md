# V4.2 Контроль доступу на робочому рівні
| # | Опис | L1 | L2 | L3 | CWE |
| - | ----------- | -- | -- | -- | --- |
| 4.2.1 | Переконайтеся, що конфіденційні дані та API захищені від атак на небезпечне пряме посилання на об’єкт (IDOR), націлених на створення, читання, оновлення та видалення записів, наприклад створення чи оновлення запису іншого користувача, перегляд записів кожного або видалення всіх записів. | ✓ | ✓ | ✓ | 639 |
| 4.2.2 | Переконайтеся, що програма або фреймворк використовує надійний механізм захисту від CSRF (міжсайтової підробки запитів) для захисту автентифікованих функцій, а ефективний захист від автоматизації або анти-CSRF захищає неавтентифіковані функції. | ✓ | ✓ | ✓ | 352 |

## CWE-639: Обхід авторизації через керований користувачем ключ

### Опис:
Функція авторизації системи не перешкоджає одному користувачеві отримати доступ до даних або запису іншого користувача шляхом зміни значення ключа, що ідентифікує дані.

### Розширений опис:
Отримання запису користувача відбувається в системі на основі деякого значення ключа, яке знаходиться під контролем користувача. Ключ зазвичай ідентифікує пов’язаний з користувачем запис, що зберігається в системі, і використовуватиметься для пошуку цього запису для представлення користувачеві. Цілком ймовірно, що зловмисник повинен бути автентифікованим користувачем у системі. Однак процес авторизації не буде належним чином перевіряти операцію доступу до даних, щоб переконатися, що автентифікований користувач, який виконує операцію, має достатні повноваження для виконання запитуваного доступу до даних, отже обходячи будь-які інші перевірки авторизації, присутні в системі.

Наприклад, зловмисники можуть переглядати місця, де витягуються дані користувача (наприклад, екрани пошуку), і визначати, чи ключ для шуканого елемента можна контролювати ззовні. Ключ може бути прихованим полем у полі форми HTML, може передаватися як параметр URL-адреси або як незашифрована змінна cookie, тоді в кожному з цих випадків можна буде змінити значення ключа.

Одним із проявів цієї вразливості є те, що система використовує послідовні або інакше легко вгадані ідентифікатори сеансу, які дозволяють одному користувачеві легко переключатися на сеанс іншого користувача та читати/змінювати їхні дані.

### Вразливі платформи:
Не залежить від мови.

Звичайні наслідки:
| Розділ | Вплив |
| ------ | ----- |
| Контроль доступу | Перевірки контролю доступу для певних даних або функцій користувача можна обійти. Технічні наслідки: подолання механізму захисту. |
| Контроль доступу | Можливе горизонтальне підвищення привілеїв (один користувач може переглядати/змінювати інформацію іншого користувача). Технічні наслідки: Отримання привілеїв, крадіжка особи користувача |
| Контроль доступу | Вертикальна ескалація привілеїв можлива, якщо контрольований користувачем ключ насправді є прапорцем, який вказує на статус адміністратора, що дозволяє зловмиснику отримати адміністративний доступ. Технічні наслідки: Отримання привілеїв, крадіжка особи користувача |

### Ймовірність використання вразливості:
Висока.

## CWE-352: Міжсайтова підробка запитів (CSRF)

### Опис:
Веб-додаток не перевіряє або не може належним чином перевірити, чи правильно сформований, дійсний, послідовний запит, поданий користувачем.

### Розширений опис
Якщо веб-сервер призначений для отримання запиту від клієнта без будь-якого механізму перевірки того, що він надісланий навмисно, тоді зловмисник може обманом змусити клієнта зробити ненавмисний запит до веб-сервера, який буде розглядатися як справжній запит. Це можна зробити за допомогою URL-адреси, завантаження зображення, XMLHttpRequest тощо, що може призвести до розкриття даних або виконання коду на сервері.

### Вразливі платформи:
Не залежить від мови.
Технології: веб сервери.

### Звичайні наслідки:
| Розділи | Вплив |
| ------ | ----- |
| Конфіденційнісь, цілісність, доступність, невідмовність, контроль доступу | Наслідки відрізнятимуться залежно від характеру функціональності, вразливої до CSRF. Зловмисник міг ефективно виконувати будь-які операції в якості жертви. Якщо жертва є адміністратором або привілейованим користувачем, наслідки можуть включати отримання повного контролю над веб-додатком – видалення або викрадення даних, видалення продукту або його використання для здійснення інших атак проти всіх користувачів продукту. Оскільки зловмисник має особу жертви, сфера дії CSRF обмежена лише привілеями жертви. | Технічний вплив: Отримання привілеї або підробка особи; подолання захисного механізму; Читання даних програми; Змінити даних програми; DoS: збій, вихід або перезапуск системи.

### Ймовірність використання вразливості:
Середня.
